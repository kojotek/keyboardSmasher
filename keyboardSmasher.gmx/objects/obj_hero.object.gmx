<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_runner</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>start_position_x = x;
start_position_beat = 0;

horizontal_speed = 0;
last_known_y = y;
next_y = y;
vertical_direction = DOWNWARDS;
horizontal_direction = 1;

movement_type = FALL;

jump_start_x = x;
jump_start_y = y;
jump_start_beat = 0;
short_jump_height = 224;
short_jump_length = 2;//32 * horizontal_speed;
long_jump_height = 320;
long_jump_length = 4;//64 * horizontal_speed;
actual_jump_length = 0;

fall_start_x = x;
fall_start_y = y;
fall_start_beat = 0;
fall_height = 320;
fall_length = 2;//64 * horizontal_speed;

dash_start_x = -1000;
dash_start_beat = 0;
dash_length = 4;
dash_available = false;
dash_started = false;

slide_start_x = x;
slide_start_beat = 0;
slide_length = 2;
actual_slide_length = 2;

on_ground = false;
touch_ceiling = false;

short_jump_key = false;
long_jump_key = false;
dash_key = false;
slide_key = false;
left_key = false;
right_key = false;

image_speed = 0;
sprite_index = spr_runner;
mask_index = spr_mask_big;

animation_start_x = 0;
animation_start_beat = 0;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/************************************************************
    BULLET COLLISION
************************************************************/

vertical_direction = sign(next_y-y);
var collision_occured = false;


//jezeli obiekt spada, lub porusza sie w gore
if (vertical_direction != CONSTANT_ALTITUDE){


    //petla bullet collision
    do{
        if (place_meeting(x,y,obj_collidable)){
            collision_occured = true;
            event_perform(ev_other, EVENT_OUT_FROM_OBJECT);        //wychodzenie z kolidujacych obiektow
            break;
        }
        else{
            y += 31 * vertical_direction;
        }
    }
    until(  !((y &lt; next_y) &amp;&amp; (vertical_direction == DOWNWARDS)) 
        &amp;&amp;  !((y &gt; next_y) &amp;&amp; (vertical_direction == UPWARDS)))
    
        
    //jezeli kolizja nie zaszla, ustaw obiekt tam, gdzie powinien finalnie sie znalezc
    if (!collision_occured){
        y = next_y;
    }

}

//po calej petli wychodzimy z kolizji jeszcze raz
event_perform(ev_other, EVENT_OUT_FROM_OBJECT);


/************************************************************
    Kontakt z gruntem
************************************************************/

on_ground = position_meeting(x-sprite_width/2, y+sprite_height/2, obj_collidable) || position_meeting(x+sprite_width/2, y+sprite_height/2, obj_collidable);
touch_ceiling = position_meeting(x-sprite_width/2, y-sprite_height/2-1, obj_collidable) || position_meeting(x+sprite_width/2, y-sprite_height/2-1, obj_collidable);



//view_xview[0] = x-200;
image_index = (floor(global.room_controller.beats*image_number-animation_start_beat)) mod image_number;

if (sprite_index == spr_ball){
    image_angle = -2*x;
}
else{
    image_angle = 0;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (keyboard_check_pressed(ord('Z')))
    short_jump_key = KEY_DURATION;

if (keyboard_check_pressed(ord('X')))
    long_jump_key = KEY_DURATION;

if (keyboard_check_pressed(ord('C')))
    dash_key = KEY_DURATION;
    
if (keyboard_check_pressed(ord('V')))
    slide_key = KEY_DURATION;

left_key = keyboard_check(vk_left);
right_key = keyboard_check(vk_right);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/*************************************************************************************************
    obsluga ruchu
*************************************************************************************************/

if (right_key != left_key){
    horizontal_direction = (right_key - left_key);
    horizontal_speed = clamp(-10,horizontal_speed+horizontal_direction/2,10);
}
else{
    if (abs(horizontal_speed) &lt; 1)
        horizontal_speed = 0;
    else
        horizontal_speed -= sign(horizontal_speed)/2;
}

x += horizontal_speed;

if (movement_type == RUN){
    if (abs(horizontal_speed) &lt; 2)
        sprite_index = spr_stand;
    else
        sprite_index = spr_runner;
}

image_xscale = sign(horizontal_direction);

/*************************************************************************************************
    obsluga skokow
*************************************************************************************************/

if (short_jump_key &gt; 0 &amp;&amp; on_ground &amp;&amp; (movement_type == RUN || movement_type == SLIDE) ){
    movement_type = JUMP;
    on_ground = false;
    actual_jump_height = short_jump_height;
    actual_jump_length = short_jump_length;// - ((x mod 32) &lt; 16) * (x mod 32) + ((x mod 32) &gt; 16) * (32-(x mod 32));
    jump_start_x = x;
    jump_start_y = y;
    jump_start_beat = global.room_controller.beats;
    sprite_index = spr_jumper;
    mask_index = spr_mask_big;
    animation_start_beat = global.room_controller.beats;
}


if (long_jump_key &gt; 0 &amp;&amp; on_ground &amp;&amp; movement_type == RUN){
    movement_type = JUMP;
    on_ground = false;
    actual_jump_height = long_jump_height;
    actual_jump_length = long_jump_length;// - ((x mod 32) &lt; 16) * (x mod 32) + ((x mod 32) &gt; 16) * (32-(x mod 32));
    jump_start_x = x;
    jump_start_y = y;
    jump_start_beat = global.room_controller.beats;
    sprite_index = spr_jumper;
    mask_index = spr_mask_big;
    animation_start_beat = global.room_controller.beats;
}


/*************************************************************************************************
    obsluga szybowania
*************************************************************************************************/

if (dash_key &gt; 0 &amp;&amp; dash_available &amp;&amp; !on_ground){
    dash_available = false;
    //obliczamy wysokosc rozpoczecia szybowania
    var dash_alititude = ((y div 32) + (vertical_direction==DOWNWARDS)) * 32;
    y = dash_alititude;
    next_y = y;
    movement_type = DASH;
    dash_start_x = x;
    dash_start_beat = global.room_controller.beats;
    dash_started = false;
    sprite_index = spr_bullet;
    mask_index = spr_mask_small;
    animation_start_beat = global.room_controller.beats;
    audio_play_sound(snd_shot,100,0);
}


/*************************************************************************************************
    obsluga slizgu
*************************************************************************************************/

if (slide_key &gt; 0 &amp;&amp; on_ground){
    slide_start_x = x;
    slide_start_beat = global.room_controller.beats;
    actual_slide_length = slide_length;// - ((x mod 32) &lt; 16) * (x mod 32) + ((x mod 32) &gt; 16) * (32-(x mod 32));
    movement_type = SLIDE;
    sprite_index = spr_ball;
    mask_index = spr_mask_small;
    animation_start_beat = global.room_controller.beats;
    y += 30;
}


switch (movement_type)
{
    case RUN:
        event_perform(ev_other, EVENT_RUN);
        break;

    case JUMP:
        event_perform(ev_other, EVENT_JUMP);
        break;
        
    case DASH:
        event_perform(ev_other, EVENT_DASH);
        break;

    case SLIDE:
        event_perform(ev_other, EVENT_SLIDE);
        break;
        
    case FALL:
        event_perform(ev_other, EVENT_FALL);
        break;
}


if (on_ground)
{
    dash_available = true;
}

short_jump_key -= (global.current_time_controller.frame_time/1000);
long_jump_key -= (global.current_time_controller.frame_time/1000);
dash_key -= (global.current_time_controller.frame_time/1000);
slide_key -= (global.current_time_controller.frame_time/1000);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="40">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>audio_stop_all();
room_restart();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="15">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>run</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (on_ground){
    next_y = y;
}
else{
    movement_type = FALL;
    fall_start_x = x;
    fall_start_y = y;
    fall_start_beat = global.room_controller.beats;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="14">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>slide</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (! on_ground){
    sprite_index = spr_runner;
    mask_index = spr_mask_big;
    animation_start_beat = global.room_controller.beats;
    movement_type = FALL;
    fall_start_x = x;
    fall_start_y = y;
    fall_start_beat = global.room_controller.beats;
}

if (global.room_controller.beats &lt; slide_start_beat + actual_slide_length ){
    next_y = y;
}
else{
    if (touch_ceiling){
        actual_slide_length++;
    }
    else{
        sprite_index = spr_runner;
        mask_index = spr_mask_big;
        movement_type = RUN;
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="13">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>fall</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>next_y = fall_start_y + 4*(fall_height/(fall_length*fall_length))*(global.room_controller.beats - fall_start_beat)*(global.room_controller.beats - fall_start_beat);

show_debug_message(next_y);

if (on_ground &amp;&amp; vertical_direction == DOWNWARDS){
    movement_type = RUN;
    sprite_index = spr_runner;
    mask_index = spr_mask_big;
    animation_start_x = x;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="12">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>dash</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (global.room_controller.beats &lt; dash_start_beat + dash_length ){
    next_y = y;
    horizontal_speed = 10*horizontal_direction;
}
else{
    movement_type = FALL;
    fall_start_x = x;
    fall_start_y = y;
    fall_start_beat = global.room_controller.beats;
    sprite_index = spr_jumper;
    mask_index = spr_mask_big;
    animation_start_beat = global.room_controller.beats;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="11">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>jump</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>next_y = jump_start_y + (4*(actual_jump_height/(actual_jump_length*actual_jump_length))*(global.room_controller.beats - jump_start_beat)*(global.room_controller.beats - jump_start_beat) - 4*(global.room_controller.beats - jump_start_beat)*(actual_jump_height/actual_jump_length) );

if (on_ground &amp;&amp; vertical_direction == DOWNWARDS){
    movement_type = RUN;
    sprite_index = spr_runner;
    mask_index = spr_mask_big;
    animation_start_x = x;
}

/*
if (touch_ceiling){
    if (abs(x - (jump_start_x+actual_jump_height/2))&gt; 31)
    {
        fall_start_x = x;
        fall_start_y = y;
        movement_type = FALL;
    }
}
*/
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="10">
      <action>
        <libid>1</libid>
        <id>605</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>0</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>go out from colliding objects</string>
          </argument>
        </arguments>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
while (position_meeting(x, y+sprite_height/2-1, obj_collidable))
{
    y = y-1;
}

while (position_meeting(x, y-sprite_height/2+1, obj_collidable))
{
    y = y+1;
}

while (position_meeting(x+sprite_width/2-1, y-sprite_height/4, obj_collidable) 
    || position_meeting(x+sprite_width/2-1, y+sprite_height/4, obj_collidable))
{
    x = x-1;
}

while (position_meeting(x-sprite_width/2+1, y-sprite_height/4, obj_collidable) 
    || position_meeting(x-sprite_width/2+1, y+sprite_height/4, obj_collidable))
{
    x = x+1;
}

y = floor(y)
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_sprite_ext(sprite_index,image_index,x,y,image_xscale,image_yscale,image_angle,image_blend,image_alpha);

if (global.room_controller.beats - dash_start_beat &lt; sprite_get_number(spr_smoke)/10){
    draw_sprite_ext(spr_smoke, (global.room_controller.beats-dash_start_beat)*10, dash_start_x,y,1,1,0,image_blend,1);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="32">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>audio_stop_all();
room_restart();
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
